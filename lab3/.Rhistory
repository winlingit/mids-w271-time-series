knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir = "C:/Users/kctob/OneDrive/Documents/Berkeley/271/mids-w271-time-series/lab2")
library(car)
library(stargazer)
library(Hmisc)
library(effects)
library(astsa)
library(forecast)
install.packages("forecast")
library(forecast)
unemp = read.csv("UNRATENSA.csv")
View(unemp)
head(unemp); tail(unemp)
x = ts(unemp$UNRATENSA, start = c(1948, 1), frequency=12)
plot.ts(x, main = 'Unemployment rate by month, January 1948 - June 2017', ylab = 'Unemployment rate (%)')
View(unemp)
View(unemp)
summary(unemp)
class(unemp)
class(unemp$DATE)
hist(x)
x = ts(unemp$UNRATENSA, start = c(1948, 1), frequency=12)
plot.ts(x, main = 'Unemployment rate by month, January 1948 - June 2017', ylab = 'Unemployment rate (%)')
acf2(x, 370)
View(unemp)
hist(x)
?acf2(x, 370)
acf2(x, 370)
lx = log(x)  # log transform to stabilize variance
acf2(lx, 130)  # ACF gradual decay
acf2(x, 500)
acf2(x, 50)
acf2(lx, 370)  # ACF gradual decay
dlx = diff(lx)  # diff by 1 lag to remove monthly trend
acf2(dlx, 130)
ddlx = diff(dlx, lag=12)  # diff by 12 lags to remove seasonal trend
acf2(ddlx, 250)
plot.ts(cbind(x,lx,dlx,ddlx), main='Unemployment rate by month, January 1948 - June 2017')
train = window(x, end=c(2015,12), frequency=12)
test = window(x, start=c(2016,1), frequency=12)
# fit model on training set and run diagnostics
# 1. SARIMA(0,1,0)x(0,1,1)
train = window(x, end=c(2015,12), frequency=12)
test = window(x, start=c(2016,1), frequency=12)
# find seasonal orders P, Q
for (P in 0:2) {
for(Q in 0:2) {
fit = Arima(train, order=c(0,1,0), seasonal=list(order=c(P,1,Q)), method='ML')
print(c(P,Q,fit$aic))
}
}
# find orders p, q
for (p in 0:2) {
for(q in 0:2) {
fit = Arima(train, order=c(p,1,q), seasonal=list(order=c(0,1,1)), method='ML')
print(c(p,q,fit$aic))
}
}
# # with astsa
# fit1 = sarima(train, 0,1,0, 0,1,1,12)
# acf2(resid(fit1$fit), 250)
#
# # 2. SARIMA(1,1,0)x(0,1,1)
# fit2 = sarima(train, 1,1,0, 0,1,1,12)
# acf2(resid(fit2$fit), 250)
#
# # 3. SARIMA(2,1,0)x(0,1,1)
# fit3 = sarima(train, 2,1,0, 0,1,1,12)
# acf2(resid(fit3$fit), 250)
#
# # 4. SARIMA(0,2,0)x(0,1,1)
# fit4 = sarima(train, 0,2,0, 0,1,1,12)
# acf2(resid(fit4$fit), 250)
#
# # SARIMA(0,2,1)x(0,1,1)
# fit5 = sarima(train, 0,2,1, 0,1,1,12)
# acf2(resid(fit5$fit), 250)
#
# fit1[c('AIC','AICc','BIC')]
# fit2[c('AIC','AICc','BIC')]
# fit3[c('AIC','AICc','BIC')]  # best fit, lowest BIC
# fit4[c('AIC','AICc','BIC')]
# fit5[c('AIC','AICc','BIC')]
# 2-year forecast for 2016-2017
for2y = sarima.for(train,24, 0,1,0, 0,1,1,12)
comp2y = ts.intersect(test, for24$pred)
comp2y = ts.intersect(test, for2y$pred)
ts.plot(comp2y, lty=c(1,2), main='Unemployment rate by month, 2016-2017: Actuals and Forecast', ylab='Unemployment rate (%)')
for5y = sarima.for(train,60, 0,1,0, 0,1,1,12)
for5y
for5y = sarima.for(train,60, 0,1,0, 0,1,1,12)
rm(list = ls())
for5y = sarima.for(train,60, 0,1,0, 0,1,1,12)
knitr::opts_chunk$set(echo = TRUE)
#knitr::opts_knit$set(root.dir = "C:/Users/kctob/OneDrive/Documents/Berkeley/271/mids-w271-time-series/lab2")
library(car)
library(stargazer)
library(Hmisc)
library(effects)
library(astsa)
library(forecast)
# EDA
unemp = read.csv("UNRATENSA.csv")
head(unemp); tail(unemp)
x = ts(unemp$UNRATENSA, start = c(1948, 1), frequency=12)
plot.ts(x, main = 'Unemployment rate by month, January 1948 - June 2017', ylab = 'Unemployment rate (%)')
hist(x)
acf2(x, 50)
lx = log(x)  # log transform to stabilize variance
acf2(lx, 370)  # ACF gradual decay
dlx = diff(lx)  # diff by 1 lag to remove monthly trend
acf2(dlx, 130)
ddlx = diff(dlx, lag=12)  # diff by 12 lags to remove seasonal trend
acf2(ddlx, 250)
plot.ts(cbind(x,lx,dlx,ddlx), main='Unemployment rate by month, January 1948 - June 2017')
rm()
list = ls()
rm(list = ls())
# EDA
unemp = read.csv("UNRATENSA.csv")
head(unemp); tail(unemp)
x = ts(unemp$UNRATENSA, start = c(1948, 1), frequency=12)
plot.ts(x, main = 'Unemployment rate by month, January 1948 - June 2017', ylab = 'Unemployment rate (%)')
hist(x)
acf2(x, 50)
lx = log(x)  # log transform to stabilize variance
acf2(lx, 370)  # ACF gradual decay
dlx = diff(lx)  # diff by 1 lag to remove monthly trend
acf2(dlx, 130)
ddlx = diff(dlx, lag=12)  # diff by 12 lags to remove seasonal trend
acf2(ddlx, 250)
plot.ts(cbind(x,lx,dlx,ddlx), main='Unemployment rate by month, January 1948 - June 2017')
?rm(list = ls())
hist(x)
acf2(x, 50)
acf2(x, 370)
par(mfrow = c(2,2))
?par(mfrow = c(2,2))
?par(mfrow = c(2,2))
x <- seq(-3,3, length = 1000)
hist(rnorm(100), prob = T); points(x, dnorm(x), type = "l")
hist(rnorm(100), prob = T)
hist(rnorm(100))
, prob = T
hist(rnorm(100), prob = T)
points(x, dnorm(x), type = "l")
hist(rnorm(100), prob = T); points(x, dnorm(x), type = "l")
dnorm(x)
?dnorm(x)
x <- w <- rnorm(1000)
for (t in 2:1000) x[t] <- x[t - 1] + w[t]
plot(x, type = "l")
acf(x)
pacf(x)
aggregate(x)
aggregate(x, FUN = mean)
x <- w <- rnorm(1000)
aggregate(x, FUN = mean)
?aggregate(x, FUN = mean)
?aggregate(x)
aggregate(x)
