---
title: "Ch. 3 Examples"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
wine = read.table('wine.dat', header = T)
attach(wine)

sweetw.ts = ts(sweetw, start = c(1980,1), freq = 12)
plot(sweetw.ts, xlab = 'Time (months)', ylab = 'sales(1000 litres)')

# Holt-Winters exponential smoother
sweetw.hw = HoltWinters(sweetw.ts, seasonal = 'mult')
sweetw.hw; sweetw.hw$coef; sweetw.hw$SSE
sqrt(sweetw.hw$SSE / length(sweetw))
sd(sweetw)

plot(sweetw.hw$fitted)
plot(sweetw.hw)
```

```{r}
ap.hw = HoltWinters(ap, seasonal = 'mult')
plot(ap.hw)

# prediction with H-W smoother
ap.predict = predict(ap.hw, n.ahead = 4*12)
ts.plot(ap, ap.predict, lty = 1:2)
```